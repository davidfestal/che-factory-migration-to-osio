<html>
<head>
    <meta charset="utf-8">
    <title>Migration of Codenvy.io factories to Openshift.io</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <style>
    </style>
</head>

<body>
    <div class="container">    
        <div class="row">
            <h3>Migration of Codenvy.io factories to Openshift.io</h3>
            <div class="row">
                <label for="osio-info">Information of the OSIO account into which factories should be migrated</label>
                <div id="osio-info" class="row">
                    <div class="col-lg-6">
                        <div class="input-group">
                            <span class="input-group-addon" id="che-api-url-header">Che server API URL</span>
                            <input type="text" class="form-control" id="che-api-url" aria-describedby="che-api-url-header">
                        </div>            
                    </div>
                    <div class="col-lg-6">
                        <div class="input-group">
                            <span class="input-group-addon" id="osio-token-header">OSIO token</span>
                            <input type="text" class="form-control" id="osio-token" aria-describedby="osio-token-header">
                        </div>            
                    </div>
                </div>
            </div>
        </div>
        <hr></hr>
        <div id="tabs" class="container">    
            <ul  class="nav nav-tabs">
                <li class="active"><a  href="#tab1" data-toggle="tab">Codenvy factories</a></li>
                <li><a href="#tab2" data-toggle="tab">OSIO factories</a></li>
                <li><a href="#tab3" data-toggle="tab">Migration</a></li>
            </ul>
    
            <div class="tab-content">
                <div class="tab-pane active" id="tab1">
                    <div class="row">
                        <h3>Manage Codenvy factories available on the Eclipse site</h3>
                    </div>
                    <div class="row">
                      <div class="col-lg-2">
                        <div class="input-group">
                          <span class="input-group-btn">
                            <button id="describeCodenvyFactories" class="btn" type="button">Get Eclipse Factories</button>
                          </span>
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="input-group">
                          <input type="text" id="codenvyFactoryName" class="form-control" placeholder="Factory name">
                          <span class="input-group-btn">
                            <button id="retrieveCodenvyFactoryByName" class="btn" type="button">Find by name</button>
                          </span>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="input-group">
                          <input type="text" id="codenvyFactoryId" class="form-control" placeholder="Factory Id">
                          <span class="input-group-btn">
                            <button id="exportCodenvyFactory" class="btn" type="button">Export</button>
                          </span>
                          <span class="input-group-btn">
                            <button id="exportAsOsioFactory" class="btn" type="button">Export for OSIO</button>
                          </span>
                        </div>
                      </div>
                    </div>
                </div>
                <div class="tab-pane" id="tab2">
                    <div class="row">
                        <h3>Manage already-existing OSIO factories available in the given OSIO account</h3>
                    </div>
                    <div class="row">
                      <div class="col-lg-2">
                        <div class="input-group">
                          <span class="input-group-btn">
                            <button id="retrieveExistingOsioFactories" class="btn" type="button">Existing Factories</button>
                          </span>
                        </div>
                      </div>
                      <div class="col-lg-2">
                        <div class="input-group">
                          <span class="input-group-btn">
                            <button id="retrieveMissingOsioFactories" class="btn" type="button">Missing Factories</button>
                          </span>
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="input-group">
                          <input type="text" id="osioFactoryName" class="form-control" placeholder="Osio Factory name">
                          <span class="input-group-btn">
                            <button id="retrieveExistingOsioFactoryByName" class="btn" type="button">Find</button>
                          </span>
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="input-group">
                          <input type="text" id="osioFactoryId" class="form-control" placeholder="Osio Factory Id">
                          <span class="input-group-btn">
                            <button id="retrieveExistingOsioFactory" class="btn" type="button">Export</button>
                            <button id="deleteExistingOsioFactory" class="btn" type="button">Delete</button>
                          </span>
                        </div>
                      </div>
                    </div>
                </div>
                <div class="tab-pane" id="tab3">
                    <div class="row">
                        <h3>Migrate Codenvy.io factories to the given OSIO account</h3>
                    </div>
                    <div class="row">
                      <div class="col-lg-8">
                        <div class="input-group">
                          <input type="text" id="codenvyFactoryIdToMigrate" class="form-control" placeholder="Codenvy Factory Id">
                          <span class="input-group-btn">
                            <button id="migrateOsioFactory" class="btn" type="button">Migrate</button>
                            <button id="migratedOsioFactory" class="btn" type="button">Show migrated</button>
                          </span>
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="input-group">
                          <span class="input-group-btn">
                            <button id="migrateOsioFactories" class="btn" type="button">Migrate all</button>
                            <button id="migratedOsioFactories" class="btn" type="button">Show all migrated</button>
                          </span>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
        <hr></hr>
        <div class="row">
            <h3>Result</h3>
            <pre><code id="result">Invoke the service to see the result.</code></pre>
        </div>
    </div>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    
    <script>
      function register(id, buildUrl, method = $.getJSON) {
        $(id).click(function (e) {
          method(buildUrl())
          .done(function (res) {
            $("#result").text(JSON.stringify(res, null, 2));
          })
          .fail(function (res) {
            $("#result").text(JSON.stringify(res, null, 2));
          });
          e.preventDefault();
        });
      }
    
      function osioQueryParameters() {
          return "che-api-url=" + encodeURIComponent($("#che-api-url").val()) + "&token=" + encodeURIComponent($("#osio-token").val());
      }

      $.delete = function(url, callback){
         
          return $.ajax({
            url: url,
            type: 'DELETE',
            success: callback,
            data: {},
            contentType: "application/json"
          });
      }
      
      $(document).ready(function () {
        register("#describeCodenvyFactories", () => "/api/codenvy/full");
        register("#exportCodenvyFactory", () => "/api/codenvy/export/" + $("#codenvyFactoryId").val());
        register("#retrieveCodenvyFactoryByName", () => "/api/codenvy/find/" + encodeURIComponent($("#codenvyFactoryName").val()));
        register("#exportAsOsioFactory", () => "/api/codenvy/transform/" + $("#codenvyFactoryId").val());
        register("#retrieveExistingOsioFactories", () => "/api/osio/existing?" + osioQueryParameters());
        register("#retrieveMissingOsioFactories", () => "/api/osio/missing?" + osioQueryParameters());
        register("#retrieveExistingOsioFactoryByName", () => "/api/osio/find/" + encodeURIComponent($("#osioFactoryName").val()) + "?" + osioQueryParameters());
        register("#retrieveExistingOsioFactory", () => "/api/osio/existing/" + $("#osioFactoryId").val() + "?" + osioQueryParameters());
        register("#deleteExistingOsioFactory", () => "/api/osio/existing/" + $("#osioFactoryId").val() + "?" + osioQueryParameters(), $.delete);
        register("#migrateOsioFactories", () => "/api/migrate?" + osioQueryParameters());
        register("#migrateOsioFactory", () => "/api/migrate/" + $("#codenvyFactoryIdToMigrate").val() + "?" + osioQueryParameters());
        register("#migratedOsioFactories", () => "/api/migrated?" + osioQueryParameters());
        register("#migratedOsioFactory", () => "/api/migrated/" + $("#codenvyFactoryIdToMigrate").val() + "?" + osioQueryParameters());
      });
    </script>

</body>

</html>
